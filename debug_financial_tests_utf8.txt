============================= test session starts =============================
platform win32 -- Python 3.13.1, pytest-7.4.0, pluggy-1.6.0 -- C:\Users\astir\Desktop\AI_Company\AI_Investor\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\astir\Desktop\AI_Company\AI_Investor
configfile: pytest.ini
plugins: anyio-4.12.1, asyncio-0.21.1, base-url-2.1.0
asyncio: mode=Mode.AUTO
collecting ... collected 12 items

tests/api/test_estate_api.py::test_create_estate_plan_success FAILED     [  8%]
tests/api/test_estate_api.py::test_create_estate_plan_missing_params FAILED [ 16%]
tests/api/test_estate_api.py::test_get_estate_plan_success FAILED        [ 25%]
tests/api/test_estate_api.py::test_calculate_estate_tax_success FAILED   [ 33%]
tests/api/test_billing_api.py::test_create_bill_success FAILED           [ 41%]
tests/api/test_billing_api.py::test_create_bill_missing_params FAILED    [ 50%]
tests/api/test_billing_api.py::test_get_upcoming_bills_success FAILED    [ 58%]
tests/api/test_billing_api.py::test_create_reminder_success FAILED       [ 66%]
tests/api/test_credit_api.py::test_track_credit_score_success FAILED     [ 75%]
tests/api/test_credit_api.py::test_track_credit_score_missing_params FAILED [ 83%]
tests/api/test_credit_api.py::test_get_credit_history_success FAILED     [ 91%]
tests/api/test_credit_api.py::test_get_recommendations_success FAILED    [100%]

================================== FAILURES ===================================
_______________________ test_create_estate_plan_success _______________________
tests\api\test_estate_api.py:50: in test_create_estate_plan_success
    mock_plan = EstatePlan(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for EstatePlan
E   created_date
E     Field required [type=missing, input_value={'plan_id': 'plan_1', 'us...state_value': 1000000.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   updated_date
E     Field required [type=missing, input_value={'plan_id': 'plan_1', 'us...state_value': 1000000.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
___________________ test_create_estate_plan_missing_params ____________________
tests\api\test_estate_api.py:72: in test_create_estate_plan_missing_params
    response = client.post('/api/estate/plan/create', json={'user_id': 'user_1'})
venv\Lib\site-packages\werkzeug\test.py:1167: in post
    return self.open(*args, **kw)
venv\Lib\site-packages\flask\testing.py:235: in open
    response = super().open(
venv\Lib\site-packages\werkzeug\test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1536: in __call__
    return self.wsgi_app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1514: in wsgi_app
    response = self.handle_exception(e)
venv\Lib\site-packages\flask\app.py:1511: in wsgi_app
    response = self.full_dispatch_request()
venv\Lib\site-packages\flask\app.py:919: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv\Lib\site-packages\flask\app.py:917: in full_dispatch_request
    rv = self.dispatch_request()
venv\Lib\site-packages\flask\app.py:902: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
venv\Lib\site-packages\asgiref\sync.py:233: in __call__
    raise RuntimeError(
E   RuntimeError: You cannot use AsyncToSync in the same thread as an async event loop - just await the async function directly.
________________________ test_get_estate_plan_success _________________________
tests\api\test_estate_api.py:84: in test_get_estate_plan_success
    mock_plan = EstatePlan(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for EstatePlan
E   created_date
E     Field required [type=missing, input_value={'plan_id': 'plan_1', 'us...state_value': 1000000.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   updated_date
E     Field required [type=missing, input_value={'plan_id': 'plan_1', 'us...state_value': 1000000.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
______________________ test_calculate_estate_tax_success ______________________
tests\api\test_estate_api.py:102: in test_calculate_estate_tax_success
    from models.estate import EstateTaxCalculation
E   ImportError: cannot import name 'EstateTaxCalculation' from 'models.estate' (C:\Users\astir\Desktop\AI_Company\AI_Investor\models\estate.py)
__________________________ test_create_bill_success ___________________________
tests\api\test_billing_api.py:51: in test_create_bill_success
    mock_bill = Bill(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for Bill
E   created_date
E     Field required [type=missing, input_value={'bill_id': 'bill_1', 'us...'recurrence': 'monthly'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   updated_date
E     Field required [type=missing, input_value={'bill_id': 'bill_1', 'us...'recurrence': 'monthly'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
_______________________ test_create_bill_missing_params _______________________
tests\api\test_billing_api.py:81: in test_create_bill_missing_params
    response = client.post('/api/billing/bill/create',
venv\Lib\site-packages\werkzeug\test.py:1167: in post
    return self.open(*args, **kw)
venv\Lib\site-packages\flask\testing.py:235: in open
    response = super().open(
venv\Lib\site-packages\werkzeug\test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1536: in __call__
    return self.wsgi_app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1514: in wsgi_app
    response = self.handle_exception(e)
venv\Lib\site-packages\flask\app.py:1511: in wsgi_app
    response = self.full_dispatch_request()
venv\Lib\site-packages\flask\app.py:919: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv\Lib\site-packages\flask\app.py:917: in full_dispatch_request
    rv = self.dispatch_request()
venv\Lib\site-packages\flask\app.py:902: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
venv\Lib\site-packages\asgiref\sync.py:233: in __call__
    raise RuntimeError(
E   RuntimeError: You cannot use AsyncToSync in the same thread as an async event loop - just await the async function directly.
_______________________ test_get_upcoming_bills_success _______________________
tests\api\test_billing_api.py:95: in test_get_upcoming_bills_success
    Bill(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for Bill
E   created_date
E     Field required [type=missing, input_value={'bill_id': 'bill_1', 'us...'recurrence': 'monthly'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   updated_date
E     Field required [type=missing, input_value={'bill_id': 'bill_1', 'us...'recurrence': 'monthly'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
________________________ test_create_reminder_success _________________________
tests\api\test_billing_api.py:120: in test_create_reminder_success
    mock_reminder = PaymentReminder(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for PaymentReminder
E   reminder_date
E     Field required [type=missing, input_value={'reminder_id': 'reminder...eminder_days_before': 3}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   reminder_type
E     Field required [type=missing, input_value={'reminder_id': 'reminder...eminder_days_before': 3}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
_______________________ test_track_credit_score_success _______________________
tests\api\test_credit_api.py:50: in test_track_credit_score_success
    mock_score = CreditScore(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for CreditScore
E   report_date
E     Field required [type=missing, input_value={'score_id': 'score_1', '...: 'fico', 'factors': {}}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
___________________ test_track_credit_score_missing_params ____________________
tests\api\test_credit_api.py:75: in test_track_credit_score_missing_params
    response = client.post('/api/credit/score/track', json={'user_id': 'user_1'})
venv\Lib\site-packages\werkzeug\test.py:1167: in post
    return self.open(*args, **kw)
venv\Lib\site-packages\flask\testing.py:235: in open
    response = super().open(
venv\Lib\site-packages\werkzeug\test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1536: in __call__
    return self.wsgi_app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1514: in wsgi_app
    response = self.handle_exception(e)
venv\Lib\site-packages\flask\app.py:1511: in wsgi_app
    response = self.full_dispatch_request()
venv\Lib\site-packages\flask\app.py:919: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv\Lib\site-packages\flask\app.py:917: in full_dispatch_request
    rv = self.dispatch_request()
venv\Lib\site-packages\flask\app.py:902: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
venv\Lib\site-packages\asgiref\sync.py:233: in __call__
    raise RuntimeError(
E   RuntimeError: You cannot use AsyncToSync in the same thread as an async event loop - just await the async function directly.
_______________________ test_get_credit_history_success _______________________
tests\api\test_credit_api.py:88: in test_get_credit_history_success
    CreditScore(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for CreditScore
E   report_date
E     Field required [type=missing, input_value={'score_id': 'score_1', '...: 'fico', 'factors': {}}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
______________________ test_get_recommendations_success _______________________
tests\api\test_credit_api.py:112: in test_get_recommendations_success
    CreditRecommendation(
E   pydantic_core._pydantic_core.ValidationError: 7 validation errors for CreditRecommendation
E   factor
E     Field required [type=missing, input_value={'recommendation_id': 're...ted_score_increase': 20}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   title
E     Field required [type=missing, input_value={'recommendation_id': 're...ted_score_increase': 20}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   description
E     Field required [type=missing, input_value={'recommendation_id': 're...ted_score_increase': 20}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   impact_score
E     Input should be a valid integer, got a number with a fractional part [type=int_from_float, input_value=0.8, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.12/v/int_from_float
E   difficulty
E     Field required [type=missing, input_value={'recommendation_id': 're...ted_score_increase': 20}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   estimated_time
E     Field required [type=missing, input_value={'recommendation_id': 're...ted_score_increase': 20}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   action_items
E     Field required [type=missing, input_value={'recommendation_id': 're...ted_score_increase': 20}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
=========================== short test summary info ===========================
FAILED tests/api/test_estate_api.py::test_create_estate_plan_success - pydant...
FAILED tests/api/test_estate_api.py::test_create_estate_plan_missing_params
FAILED tests/api/test_estate_api.py::test_get_estate_plan_success - pydantic_...
FAILED tests/api/test_estate_api.py::test_calculate_estate_tax_success - Impo...
FAILED tests/api/test_billing_api.py::test_create_bill_success - pydantic_cor...
FAILED tests/api/test_billing_api.py::test_create_bill_missing_params - Runti...
FAILED tests/api/test_billing_api.py::test_get_upcoming_bills_success - pydan...
FAILED tests/api/test_billing_api.py::test_create_reminder_success - pydantic...
FAILED tests/api/test_credit_api.py::test_track_credit_score_success - pydant...
FAILED tests/api/test_credit_api.py::test_track_credit_score_missing_params
FAILED tests/api/test_credit_api.py::test_get_credit_history_success - pydant...
FAILED tests/api/test_credit_api.py::test_get_recommendations_success - pydan...
============================= 12 failed in 1.24s ==============================
