# Phase 45: Tax-Loss Harvesting (Initial Logic)

> **Status**: `[x]` Completed  
> **Last Updated**: 2026-01-25  
> **Owner**: Wealth Planning Team

---

## ðŸ“‹ Overview

**Description**: Logic to identify losing positions to shield capital gains from tax liabilities. Turn lemons into lemonade. Sell the loser, bank the tax credit, buy a correlated (but not identical) asset to stay in the market.

**Parent Roadmap**: [ROADMAP_1_14_26.md](./ROADMAP_1_14_26.md)  
**Source**: JIRA_PLANNING_JSON.txt - Phase 45

---

## ðŸŽ¯ Sub-Deliverables

### 45.1 'Loser Identification' Query `[x]`

**Acceptance Criteria**: Query Postgres portfolio state every Friday to find positions with > $X unrealized loss or > Y% loss.

| Component | File Path | Status |
|-----------|-----------|--------|
| Loser Query | `services/tax/loser_query.sql` | `[x]` |

---

### 45.2 Tax Savings Alpha Calculator `[x]`

**Acceptance Criteria**: Calculate "Tax Savings Alpha". If I harvest $1000 loss and my tax rate is 30%, I saved $300. That's real alpha.

```python
class HarvestingAlpha:
    def calculate_savings(self, loss_amount: float, tax_rate: float) -> float:
        return loss_amount * tax_rate
```

| Component | File Path | Status |
|-----------|-----------|--------|
| Alpha Calc | `services/analysis/harvest_alpha.py` | `[x]` |

---

### 45.3 Wash-Sale Protection (30-Day Rule) `[x]`

**Acceptance Criteria**: Ensure harvesting suggestions do not trigger Wash-Sale violations. Query 30-day buy history. Verify replacement asset is "Not Substantially Identical".

| Component | File Path | Status |
|-----------|-----------|--------|
| Wash Guard | `services/compliance/wash_sale.py` | `[x]` |

---

### 45.4 Fiscal Quarter Reporting `[x]`

**Acceptance Criteria**: Log the total 'Tax Shield' dollar value generated by the system per fiscal quarter.

| Component | File Path | Status |
|-----------|-----------|--------|
| Report Gen | `services/reporting/tax_shield_report.py` | `[x]` |

### 45.5 Manual Review Toggle `[x]`

**Acceptance Criteria**: Implement a manual review toggle. All automated harvesting trades must be approved by the user initially.

| Component | File Path | Status |
|-----------|-----------|--------|
| Review Toggle | `services/settings/harvest_settings.py` | `[x]` |

## ðŸ“Š Phase Status: `[ ]` NOT STARTED

---

## ðŸ”§ CLI Commands

| Command | Description | Status |
|---------|-------------|--------|
| `python cli.py harvest scan` | Find opps | `[x]` |
| `python cli.py harvest check-wash <ticker>` | Safe to buy? | `[x]` |

---

*Last verified: 2026-01-25*
