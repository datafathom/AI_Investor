============================= test session starts =============================
platform win32 -- Python 3.13.1, pytest-7.4.0, pluggy-1.6.0 -- C:\Users\astir\Desktop\AI_Company\AI_Investor\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\astir\Desktop\AI_Company\AI_Investor
configfile: pytest.ini
plugins: anyio-4.12.1, asyncio-0.21.1, base-url-2.1.0
asyncio: mode=Mode.AUTO
collecting ... collected 4 items

tests/api/test_advanced_orders_api.py::test_create_trailing_stop_success FAILED [ 25%]
tests/api/test_advanced_orders_api.py::test_create_trailing_stop_missing_params FAILED [ 50%]
tests/api/test_advanced_orders_api.py::test_create_bracket_order_success FAILED [ 75%]
tests/api/test_advanced_orders_api.py::test_execute_twap_success FAILED  [100%]

================================== FAILURES ===================================
______________________ test_create_trailing_stop_success ______________________
tests\api\test_advanced_orders_api.py:49: in test_create_trailing_stop_success
    from models.orders import Order
E   ImportError: cannot import name 'Order' from 'models.orders' (C:\Users\astir\Desktop\AI_Company\AI_Investor\models\orders.py). Did you mean: 'orders'?
__________________ test_create_trailing_stop_missing_params ___________________
tests\api\test_advanced_orders_api.py:79: in test_create_trailing_stop_missing_params
    response = client.post('/api/orders/trailing-stop',
venv\Lib\site-packages\werkzeug\test.py:1167: in post
    return self.open(*args, **kw)
venv\Lib\site-packages\flask\testing.py:235: in open
    response = super().open(
venv\Lib\site-packages\werkzeug\test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv\Lib\site-packages\werkzeug\test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1536: in __call__
    return self.wsgi_app(environ, start_response)
venv\Lib\site-packages\flask\app.py:1514: in wsgi_app
    response = self.handle_exception(e)
venv\Lib\site-packages\flask\app.py:1511: in wsgi_app
    response = self.full_dispatch_request()
venv\Lib\site-packages\flask\app.py:919: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv\Lib\site-packages\flask\app.py:917: in full_dispatch_request
    rv = self.dispatch_request()
venv\Lib\site-packages\flask\app.py:902: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
venv\Lib\site-packages\asgiref\sync.py:233: in __call__
    raise RuntimeError(
E   RuntimeError: You cannot use AsyncToSync in the same thread as an async event loop - just await the async function directly.
______________________ test_create_bracket_order_success ______________________
tests\api\test_advanced_orders_api.py:90: in test_create_bracket_order_success
    from models.orders import Order
E   ImportError: cannot import name 'Order' from 'models.orders' (C:\Users\astir\Desktop\AI_Company\AI_Investor\models\orders.py). Did you mean: 'orders'?
__________________________ test_execute_twap_success __________________________
tests\api\test_advanced_orders_api.py:122: in test_execute_twap_success
    mock_result = ExecutionResult(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for ExecutionResult
E   filled_quantity
E     Field required [type=missing, input_value={'execution_id': 'exec_1'...100, 'avg_price': 150.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   average_price
E     Field required [type=missing, input_value={'execution_id': 'exec_1'...100, 'avg_price': 150.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   execution_time
E     Field required [type=missing, input_value={'execution_id': 'exec_1'...100, 'avg_price': 150.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
E   execution_strategy
E     Field required [type=missing, input_value={'execution_id': 'exec_1'...100, 'avg_price': 150.0}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/missing
=========================== short test summary info ===========================
FAILED tests/api/test_advanced_orders_api.py::test_create_trailing_stop_success
FAILED tests/api/test_advanced_orders_api.py::test_create_trailing_stop_missing_params
FAILED tests/api/test_advanced_orders_api.py::test_create_bracket_order_success
FAILED tests/api/test_advanced_orders_api.py::test_execute_twap_success - pyd...
============================== 4 failed in 1.59s ==============================
