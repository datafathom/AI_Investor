============================= test session starts =============================
platform win32 -- Python 3.13.1, pytest-7.4.0, pluggy-1.6.0 -- C:\Users\astir\Desktop\AI_Company\AI_Investor\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\astir\Desktop\AI_Company\AI_Investor
configfile: pytest.ini
plugins: anyio-4.12.1, asyncio-0.21.1, base-url-2.1.0
asyncio: mode=Mode.AUTO
collecting ... collected 37 items

tests/integration/test_integration_framework.py::test_create_integration PASSED [  2%]
tests/integration/test_integration_framework.py::test_create_integration_unsupported_app PASSED [  5%]
tests/integration/test_integration_framework.py::test_get_supported_apps PASSED [  8%]
tests/integration/test_integration_service.py::test_sync_data PASSED     [ 10%]
tests/integration/test_integration_service.py::test_sync_data_full PASSED [ 13%]
tests/integration/test_integration_service.py::test_get_sync_status PASSED [ 16%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_list_documents PASSED [ 18%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_get_document PASSED [ 21%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_get_nonexistent_document PASSED [ 24%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_accept_documents FAILED [ 27%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_accept_documents_unauthorized PASSED [ 29%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_get_acceptance_status PASSED [ 32%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_get_acceptance_history PASSED [ 35%]
tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_check_document_updates PASSED [ 37%]
tests/integration/test_migration_system.py::TestMigrationManager::test_create_migration PASSED [ 40%]
tests/integration/test_migration_system.py::TestMigrationManager::test_list_migrations PASSED [ 43%]
tests/integration/test_migration_system.py::TestMigrationManager::test_get_pending_migrations PASSED [ 45%]
tests/integration/test_migration_system.py::TestMigrationManager::test_validate_migration PASSED [ 48%]
tests/integration/test_migration_system.py::TestMigrationManager::test_get_migration_status PASSED [ 51%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_get_onboarding_status PASSED [ 54%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_get_onboarding_status_unauthorized PASSED [ 56%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_update_onboarding_step PASSED [ 59%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_complete_onboarding PASSED [ 62%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_complete_onboarding_missing_fields PASSED [ 64%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_get_preferences PASSED [ 67%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_update_preferences PASSED [ 70%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_skip_onboarding PASSED [ 72%]
tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_reset_onboarding PASSED [ 75%]
tests/integration/test_secrets_management.py::TestSecretManager::test_get_secret_from_env PASSED [ 78%]
tests/integration/test_secrets_management.py::TestSecretManager::test_get_secret_default PASSED [ 81%]
tests/integration/test_secrets_management.py::TestSecretManager::test_get_masked_secret PASSED [ 83%]
tests/integration/test_secrets_management.py::TestSecretManager::test_get_db_credentials PASSED [ 86%]
tests/integration/test_secrets_management.py::TestSecretManager::test_get_status PASSED [ 89%]
tests/integration/test_secrets_management.py::TestProductionSecretManager::test_fallback_to_env PASSED [ 91%]
tests/integration/test_secrets_management.py::TestProductionSecretManager::test_vault_integration PASSED [ 94%]
tests/integration/test_secrets_management.py::TestAWSSecretsManager::test_aws_secrets_manager_init SKIPPED [ 97%]
tests/integration/test_secrets_management.py::TestAWSSecretsManager::test_get_secret_from_aws SKIPPED [100%]

================================== FAILURES ===================================
_________________ TestLegalDocumentFlow.test_accept_documents _________________
tests\integration\test_legal_acceptance_flow.py:78: in test_accept_documents
    assert response.status_code == 200
E   assert 401 == 200
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
============================== warnings summary ===============================
tests/integration/test_integration_framework.py::test_create_integration
  C:\Users\astir\Desktop\AI_Company\AI_Investor\services\integration\integration_framework.py:72: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    integration_id=f"integration_{user_id}_{app_name}_{datetime.utcnow().timestamp()}",

tests/integration/test_integration_framework.py::test_create_integration
  C:\Users\astir\Desktop\AI_Company\AI_Investor\services\integration\integration_framework.py:77: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_date=datetime.utcnow(),

tests/integration/test_integration_framework.py::test_create_integration
  C:\Users\astir\Desktop\AI_Company\AI_Investor\services\integration\integration_framework.py:78: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    updated_date=datetime.utcnow()

tests/integration/test_integration_service.py::test_sync_data
tests/integration/test_integration_service.py::test_sync_data_full
  C:\Users\astir\Desktop\AI_Company\AI_Investor\services\integration\integration_service.py:63: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    sync_job_id=f"sync_{integration_id}_{datetime.utcnow().timestamp()}",

tests/integration/test_integration_service.py::test_sync_data
tests/integration/test_integration_service.py::test_sync_data_full
  C:\Users\astir\Desktop\AI_Company\AI_Investor\services\integration\integration_service.py:67: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    started_date=datetime.utcnow()

tests/integration/test_integration_service.py::test_sync_data
tests/integration/test_integration_service.py::test_sync_data_full
  C:\Users\astir\Desktop\AI_Company\AI_Investor\services\integration\integration_service.py:72: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    job.completed_date = datetime.utcnow()

tests/integration/test_integration_service.py::test_get_sync_status
  C:\Users\astir\Desktop\AI_Company\AI_Investor\tests\integration\test_integration_service.py:60: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    started_date=datetime.utcnow(),

tests/integration/test_integration_service.py::test_get_sync_status
  C:\Users\astir\Desktop\AI_Company\AI_Investor\tests\integration\test_integration_service.py:61: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    completed_date=datetime.utcnow(),

tests/integration/test_migration_system.py::TestMigrationManager::test_create_migration
tests/integration/test_migration_system.py::TestMigrationManager::test_list_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_list_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_get_pending_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_get_pending_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_validate_migration
tests/integration/test_migration_system.py::TestMigrationManager::test_get_migration_status
  C:\Users\astir\Desktop\AI_Company\AI_Investor\scripts\database\migration_manager.py:49: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp = datetime.utcnow().strftime("%Y%m%d_%H%M%S")

tests/integration/test_migration_system.py::TestMigrationManager::test_create_migration
tests/integration/test_migration_system.py::TestMigrationManager::test_list_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_list_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_get_pending_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_get_pending_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_validate_migration
tests/integration/test_migration_system.py::TestMigrationManager::test_get_migration_status
  C:\Users\astir\Desktop\AI_Company\AI_Investor\scripts\database\migration_manager.py:58: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    -- Created: {datetime.utcnow().isoformat()}

tests/integration/test_migration_system.py::TestMigrationManager::test_create_migration
tests/integration/test_migration_system.py::TestMigrationManager::test_list_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_list_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_get_pending_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_get_pending_migrations
tests/integration/test_migration_system.py::TestMigrationManager::test_validate_migration
tests/integration/test_migration_system.py::TestMigrationManager::test_get_migration_status
  C:\Users\astir\Desktop\AI_Company\AI_Investor\scripts\database\migration_manager.py:77: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    -- Created: {datetime.utcnow().isoformat()}

tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_update_onboarding_step
  C:\Users\astir\Desktop\AI_Company\AI_Investor\web\api\onboarding_api.py:154: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'updated_at': datetime.utcnow().isoformat()

tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_complete_onboarding
  C:\Users\astir\Desktop\AI_Company\AI_Investor\web\api\onboarding_api.py:216: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'completed_at': datetime.utcnow().isoformat(),

tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_update_preferences
  C:\Users\astir\Desktop\AI_Company\AI_Investor\web\api\onboarding_api.py:307: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'updated_at': datetime.utcnow().isoformat()

tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_skip_onboarding
  C:\Users\astir\Desktop\AI_Company\AI_Investor\web\api\onboarding_api.py:345: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'completed_at': datetime.utcnow().isoformat()

tests/integration/test_onboarding_flow.py::TestOnboardingFlow::test_reset_onboarding
  C:\Users\astir\Desktop\AI_Company\AI_Investor\web\api\onboarding_api.py:384: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'reset_at': datetime.utcnow().isoformat()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/integration/test_legal_acceptance_flow.py::TestLegalDocumentFlow::test_accept_documents
============ 1 failed, 34 passed, 2 skipped, 37 warnings in 1.34s =============
